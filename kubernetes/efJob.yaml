apiVersion: batch/v1
kind: Job
metadata:
  name: myapp-migration-job
spec:
  template:
    metadata:
      name: myapp-migration-job
    spec:
      containers:
        #- name: myapp-migration-container2
        #  image: ghcr.io/marinosefstathiou/efimage:v1.1.1
        #  command: ["dotnet", "dev-certs", "https", "--trust"]
        - name: myapp-migration-container
          image: ghcr.io/marinosefstathiou/efimage:v1.1.1
          #command:
          #  - "/bin/sh"
          #  - "-c"
          #  - "dotnet ef database update --context WeatherDBContext"
          #command: ["dotnet", "run", "--", "migrate"] 
          command: ["dotnet", "ef", "database", "update"]
          env:
          - name: ConnectionStrings__Default
      #imagePullSecrets:
      #  - name: githubsecret
      restartPolicy: OnFailure
